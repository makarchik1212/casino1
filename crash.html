
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Crash Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; padding: 0; background: radial-gradient(circle at center, #0c0c1d, #050510 100%);
           color: white; font-family: 'Orbitron', sans-serif; overflow: hidden; }
    .stars { position: fixed; width: 100%; height: 100%; background: url('https://www.transparenttextures.com/patterns/stardust.png');
              background-size: 100px 100px; opacity: 0.15; animation: moveStars 200s linear infinite; z-index: -1; }
    @keyframes moveStars { 0% { background-position: 0 0; } 100% { background-position: -1000px -1000px; } }
    .balance { position: absolute; top: 20px; right: 30px; font-size: 18px; color: #00ffc8; }
    .container { text-align: center; margin-top: 100px; }
    .game-area { position: relative; width: 400px; height: 500px; margin: 0 auto; background: #181828;
                 border-radius: 20px; box-shadow: 0 0 20px rgba(0,255,255,0.2); overflow: hidden; }
    .rocket { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 64px; }
    .coefficient { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 24px; color: #ffcc00; }
    .controls { margin-top: 25px; }
    input { padding: 10px; font-size: 16px; width: 150px; border-radius: 8px; border: none; margin: 5px; text-align: center; }
    .btn { padding: 12px 25px; font-size: 18px; background: linear-gradient(90deg, #ff4c4c, #e63946);
            border: none; border-radius: 10px; color: white; cursor: pointer; margin-top: 10px; }
    .btn:hover { background: linear-gradient(90deg, #e63946, #ff4c4c); }
    .message { margin-top: 10px; font-size: 16px; height: 20px; }
    .timer { margin-top: 10px; font-size: 18px; color: #00ffc8; }
    .history { margin-top: 15px; font-size: 16px; color: #ccc; }
    .history span { margin: 0 4px; padding: 4px 8px; border-radius: 6px; background: #262638; }
  </style>
</head>
<body>

<div class="stars"></div>
<div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span> –∑–≤—ë–∑–¥</div>

<div class="container">
  <div class="game-area">
    <img src="rocket_star.png" id="rocket" class="rocket" alt="rocket">
    <div class="coefficient" id="coefficient">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
  </div>

  <div class="controls">
    <input type="number" id="betAmount" placeholder="–°—Ç–∞–≤–∫–∞ (–º–∏–Ω 10)">
    <input type="number" id="autoCashout" placeholder="–ê–≤—Ç–æ x..." step="0.01">
    <br>
    <button class="btn" onclick="makeBet()">–°—Ç–∞–≤–∏—Ç—å</button>
  </div>

  <div class="timer" id="timer">–î–æ –Ω–∞—á–∞–ª–∞: 10</div>
  <div class="message" id="message"></div>
  <div class="history" id="history">–ò—Å—Ç–æ—Ä–∏—è: </div>
</div>

<script>
let balance = localStorage.getItem('balance');
if (!balance || isNaN(balance)) { balance = 100; localStorage.setItem('balance', balance); }
balance = parseInt(balance);
document.getElementById('balance').innerText = balance;

let bet = 0, autoCashoutValue = 0, hasBet = false, history = [];
let rocket = document.getElementById('rocket');
let rocketBottom = 20, currentCoefficient = 1.00;
let crashPoint = 0, interval;
const GLOBAL_ROUND_START = 1745952948;

function makeBet() {
  const betInput = parseInt(document.getElementById('betAmount').value);
  const autoCash = parseFloat(document.getElementById('autoCashout').value);
  if (!isNaN(betInput) && betInput >= 10 && betInput <= balance) {
    bet = betInput;
    autoCashoutValue = autoCash;
    balance -= bet;
    localStorage.setItem('balance', balance);
    document.getElementById('balance').innerText = balance;
    hasBet = true;
    showMessage('–°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞: ' + bet + ' –∑–≤—ë–∑–¥');
  }
}

function startGame() {
  crashPoint = (Math.random() * 3 + 1.5).toFixed(2);
  currentCoefficient = 1.00;
  rocketBottom = 20;
  rocket.src = "rocket_star.png";
  rocket.style.bottom = rocketBottom + 'px';

  interval = setInterval(() => {
    currentCoefficient += 0.02;
    rocketBottom += (rocketBottom < 260) ? 1 : Math.sin(Date.now() / 200) * 2;
    rocket.style.bottom = rocketBottom + 'px';
    rocket.style.transform = `translateX(-50%) translateY(${Math.sin(Date.now()/300)*2}px)`;
    document.getElementById('coefficient').innerText = 'x' + currentCoefficient.toFixed(2);
    if (hasBet && autoCashoutValue > 0 && currentCoefficient >= autoCashoutValue) { cashOut(); }
    if (currentCoefficient >= crashPoint) { crash(); }
  }, 50);
}

function crash() {
  clearInterval(interval);
  rocket.src = "explosion_pixel.png";
  document.getElementById('coefficient').innerText = "üí• CRASH!";
  showMessage('–ö—Ä–∞—à! –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —Å–∫–æ—Ä–æ...');
  updateHistory(currentCoefficient);
  setTimeout(startRound, 4000);
}

function cashOut() {
  if (!hasBet) return;
  const win = Math.floor(bet * currentCoefficient);
  balance += win;
  localStorage.setItem('balance', balance);
  document.getElementById('balance').innerText = balance;
  hasBet = false;
  showMessage('–í—ã –≤—ã–≤–µ–ª–∏: ' + win + ' –∑–≤—ë–∑–¥!');
}

function startRound() {
  document.getElementById('coefficient').innerText = "–û–∂–∏–¥–∞–Ω–∏–µ...";
  let timeLeft = GLOBAL_ROUND_START - Math.floor(Date.now() / 1000);
  document.getElementById('timer').innerText = "–î–æ –Ω–∞—á–∞–ª–∞: " + timeLeft;
  let countdown = setInterval(() => {
    timeLeft--;
    document.getElementById('timer').innerText = "–î–æ –Ω–∞—á–∞–ª–∞: " + timeLeft;
    if (timeLeft <= 0) { clearInterval(countdown); startGame(); }
  }, 1000);
}

function showMessage(msg) { document.getElementById('message').innerText = msg; }
function updateHistory(coef) {
  history.unshift(coef.toFixed(2));
  if (history.length > 5) history.pop();
  document.getElementById('history').innerHTML = "–ò—Å—Ç–æ—Ä–∏—è: " + history.map(c => `<span>x${c}</span>`).join('');
}

startRound();
</script>
</body>
</html>
